{"version":3,"file":"component---src-pages-cats-js-f61c514dbb5163c398b1.js","mappings":"iMASMA,EAAAA,SAAAA,GAAAA,SAAAA,IAAAA,OAAAA,EAAAA,MAAAA,KAAAA,YAAAA,MAAAA,EAAAA,EAAAA,GAAAA,EAAAA,GAAAA,IAAAA,EAAAA,EAAAA,UAwCH,OAxCGA,EAEJC,YAAA,SAAYC,GACV,IAAIC,EAAW,GAWf,OAVAD,EAAKE,SAAQ,SAACC,EAAKC,GACjBH,EAASI,KACP,uBAAKC,UAAU,MAAMC,IAAG,OAASH,GAC/B,gBAAC,EAAAI,KAAD,CAAMC,GAAE,SAAWN,EAAIO,SACrB,uBAAKJ,UAAU,aAAaH,EAAIQ,UAChC,uBAAKL,UAAU,aAAaH,EAAIS,gBAKjC,uBAAKN,UAAU,0BAA0BL,IACjD,EAEDY,OAAA,WACE,MAAqCC,KAAKC,MAA1C,IAAQC,KAAAA,OAAR,MAAe,GAAf,MAAmBC,SAAAA,OAAnB,MAA8B,GAA9B,EAEA,EAAsED,EAA9DE,KAAAA,OAAR,MAAe,GAAf,IAAsEF,EAAnDG,kBAAAA,OAAnB,MAAuC,GAAvC,IAAsEH,EAA3BI,kBAAAA,OAA3C,MAA+D,GAA/D,EACA,EAA0BH,EAAlBI,SAAAA,OAAR,MAAmB,GAAnB,EAEQC,EAAiBJ,EAAjBI,aACOtB,EAASmB,EAAhBI,MACOC,EAASJ,EAAhBG,MAGFE,EAAM,IAAIC,OAAJ,KACNC,EAAaN,EAASO,QAAQH,EAAK,IAEzC,OACE,gBAAC,IAAD,CAAQJ,SAAUM,EAAYE,SAAUP,EAAcE,KAAMA,GAC1D,gBAAC,IAAD,CACEM,MAAM,WACNC,SAAU,CAAC,OAAD,iCAEXjB,KAAKf,YA2Dd,SAAsBiC,GAEpB,IAAMC,EAAS,GACXC,EAAa,EACjBF,EAAI9B,SAAQ,SAACiC,GACX,MAA4BA,EAAKC,KAAKC,YAA9BC,EAAR,EAAQA,SACR,IADA,EAAkBC,MAElB,GAAID,EAAU,CACZ,IAAMlC,EAAQ,IAAU6B,GAAQ,SAACG,GAAD,OAAWA,EAAKzB,WAAa2B,KACvDlC,GAAS,EACX6B,EAAO7B,GAAP,WAEA6B,EAAO5B,KAAK,CACVM,SAAU2B,EACV5B,QAAS8B,EAAAA,EAAAA,QAAoBF,GAC7B1B,SAAU,SAIhBsB,OAGAA,EAAa,GACfD,EAAO5B,KAAK,CACVM,SAAU,MACVD,QAAS,QACTE,SAAUsB,IAGd,OAAOD,EAxFiBQ,CAAazC,MAGpC,EAxCGF,CAAiB4C,EAAAA,WA4CvB","sources":["webpack://MyGatsby/./src/pages/cats.js"],"sourcesContent":["import React from 'react';\nimport { Link, graphql } from 'gatsby';\nimport { findIndex } from 'lodash';\nimport commonUtils from '../utils/common'\n\nimport Layout from '../components/Layout/Layout';\nimport SEO from '../components/SEO/seo';\nimport './cats.less';\n\nclass CatsPage extends React.Component {\n\n  getCatsHTML(cats) {\n    let catsHTML = [];\n    cats.forEach((cat, index) => {\n      catsHTML.push((\n        <div className=\"cat\" key={`col-${index}`}>\n          <Link to={`/cats/${cat.catLink}`}>\n            <div className=\"cat-value\">{cat.catValue}</div>\n            <div className=\"cat-count\">{cat.catCount}</div>\n          </Link>\n        </div>\n      ));\n    });\n    return <div className=\"cats-wrap page-content\">{catsHTML}</div>\n  }\n\n  render() {\n    const { data = {}, location = {} } = this.props;\n\n    const { site = {}, allMarkdownRemark = {}, allNavigationJson = {} } = data;\n    const { pathname = '' } = location;\n\n    const { siteMetadata } = site;\n    const { edges: cats } = allMarkdownRemark;\n    const { edges: navs } = allNavigationJson;\n\n    // 得到相对路径\n    const reg = new RegExp(`^${__PATH_PREFIX__}`);\n    const rePathname = pathname.replace(reg, '');\n\n    return (\n      <Layout pathname={rePathname} metadata={siteMetadata} navs={navs}>\n        <SEO\n          title=\"All cats\"\n          keywords={[`blog`, `gatsby`, `javascript`, `react`]}\n        />\n        {this.getCatsHTML(dealWithCats(cats))}\n      </Layout>\n    )\n  }\n}\n\n\nexport default CatsPage\n\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n        author\n      }\n    }\n    allMarkdownRemark {\n      edges {\n        node {\n          frontmatter {\n            category\n            draft\n          }\n        }\n      }\n    }\n    allNavigationJson {\n      edges {\n        node {\n          name\n          link\n        }\n      }\n    }\n  }\n`\n/**\n将graphql查询的结果进行处理\n原数据结果：\n[\n  {\n    \"node\": {\n      \"frontmatter\": {\n        \"category\": \"xxx\"\n      }\n    }\n  }\n]\n处理为：\n[\n  {\n    \"catValue\": \"xxx\",\n    \"catLink\": \"xxx\",\n    \"catCount\": 1\n  }\n]\n另外，进行一些边界处理\n*/\nfunction dealWithCats(arr) {\n  // 将多个tag先拆分出来\n  const result = [];\n  let noCatCount = 0; // 统计没有cat的个数\n  arr.forEach((item) => {\n    const { category, draft } = item.node.frontmatter;\n    if (draft) return;  // 屏蔽草稿\n    if (category) {\n      const index = findIndex(result, (node) => (node.catValue === category));\n        if (index >= 0) {\n          result[index]['catCount']++;\n        } else {\n          result.push({\n            catValue: category,\n            catLink: commonUtils.getHash(category),\n            catCount: 1,\n          })\n        }\n    } else {\n      noCatCount++;\n    }\n  });\n  if (noCatCount > 0) {\n    result.push({\n      catValue: '未分类',\n      catLink: 'uncat',\n      catCount: noCatCount,\n    });\n  }\n  return result;\n}"],"names":["CatsPage","getCatsHTML","cats","catsHTML","forEach","cat","index","push","className","key","Link","to","catLink","catValue","catCount","render","this","props","data","location","site","allMarkdownRemark","allNavigationJson","pathname","siteMetadata","edges","navs","reg","RegExp","rePathname","replace","metadata","title","keywords","arr","result","noCatCount","item","node","frontmatter","category","draft","commonUtils","dealWithCats","React"],"sourceRoot":""}