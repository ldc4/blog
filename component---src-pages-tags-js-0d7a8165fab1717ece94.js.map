{"version":3,"file":"component---src-pages-tags-js-0d7a8165fab1717ece94.js","mappings":"iMASMA,EAAAA,SAAAA,GAAAA,SAAAA,IAAAA,OAAAA,EAAAA,MAAAA,KAAAA,YAAAA,MAAAA,EAAAA,EAAAA,GAAAA,EAAAA,GAAAA,IAAAA,EAAAA,EAAAA,UAwCH,OAxCGA,EAEJC,YAAA,SAAYC,GACV,IAAIC,EAAW,GAWf,OAVAD,EAAKE,SAAQ,SAACC,EAAKC,GACjBH,EAASI,KACP,uBAAKC,UAAU,MAAMC,IAAG,OAASH,GAC/B,gBAAC,EAAAI,KAAD,CAAMC,GAAE,SAAWN,EAAIO,SACrB,uBAAKJ,UAAU,aAAaH,EAAIQ,UAChC,uBAAKL,UAAU,aAAaH,EAAIS,gBAKjC,uBAAKN,UAAU,0BAA0BL,IACjD,EAEDY,OAAA,WACE,MAAqCC,KAAKC,MAA1C,IAAQC,KAAAA,OAAR,MAAe,GAAf,MAAmBC,SAAAA,OAAnB,MAA8B,GAA9B,EAEA,EAAsED,EAA9DE,KAAAA,OAAR,MAAe,GAAf,IAAsEF,EAAnDG,kBAAAA,OAAnB,MAAuC,GAAvC,IAAsEH,EAA3BI,kBAAAA,OAA3C,MAA+D,GAA/D,EACA,EAA0BH,EAAlBI,SAAAA,OAAR,MAAmB,GAAnB,EAEQC,EAAiBJ,EAAjBI,aACOtB,EAASmB,EAAhBI,MACOC,EAASJ,EAAhBG,MAGFE,EAAM,IAAIC,OAAJ,KACNC,EAAaN,EAASO,QAAQH,EAAK,IAEzC,OACE,gBAAC,IAAD,CAAQJ,SAAUM,EAAYE,SAAUP,EAAcE,KAAMA,GAC1D,gBAAC,IAAD,CACEM,MAAM,WACNC,SAAU,CAAC,OAAD,iCAEXjB,KAAKf,YAgEd,SAAsBiC,GAEpB,IAAMC,EAAS,GACXC,EAAa,EACjBF,EAAI9B,SAAQ,SAACiC,GACX,MAAwBA,EAAKC,KAAKC,YAA1BrC,EAAR,EAAQA,KAAR,EAAcsC,QAEVtC,GAAQA,EAAKuC,OAAS,EACxBvC,EAAKE,SAAQ,SAACC,GACZ,IAAMC,EAAQ,IAAU6B,GAAQ,SAACG,GAAD,OAAWA,EAAKzB,WAAaR,KACzDC,GAAS,EACX6B,EAAO7B,GAAP,WAEA6B,EAAO5B,KAAK,CACVM,SAAUR,EACVO,QAAS8B,EAAAA,EAAAA,QAAoBrC,GAC7BS,SAAU,OAKhBsB,QAGAA,EAAa,GACfD,EAAO5B,KAAK,CACVM,SAAU,MACVD,QAAS,QACTE,SAAUsB,IAGd,OAAOD,EA/FiBQ,CAAazC,MAGpC,EAxCGF,CAAiB4C,EAAAA,WA4CvB","sources":["webpack://MyGatsby/./src/pages/tags.js"],"sourcesContent":["import React from 'react';\nimport { Link, graphql } from 'gatsby';\nimport { findIndex } from 'lodash';\nimport commonUtils from '../utils/common'\n\nimport Layout from '../components/Layout/Layout';\nimport SEO from '../components/SEO/seo';\nimport './tags.less';\n\nclass TagsPage extends React.Component {\n\n  getTagsHTML(tags) {\n    let tagsHTML = [];\n    tags.forEach((tag, index) => {\n      tagsHTML.push((\n        <div className=\"tag\" key={`col-${index}`}>\n          <Link to={`/tags/${tag.tagLink}`}>\n            <div className=\"tag-value\">{tag.tagValue}</div>\n            <div className=\"tag-count\">{tag.tagCount}</div>\n          </Link>\n        </div>\n      ));\n    });\n    return <div className=\"tags-wrap page-content\">{tagsHTML}</div>\n  }\n\n  render() {\n    const { data = {}, location = {} } = this.props;\n\n    const { site = {}, allMarkdownRemark = {}, allNavigationJson = {} } = data;\n    const { pathname = '' } = location;\n\n    const { siteMetadata } = site;\n    const { edges: tags } = allMarkdownRemark;\n    const { edges: navs } = allNavigationJson;\n\n    // 得到相对路径\n    const reg = new RegExp(`^${__PATH_PREFIX__}`);\n    const rePathname = pathname.replace(reg, '');\n\n    return (\n      <Layout pathname={rePathname} metadata={siteMetadata} navs={navs}>\n        <SEO\n          title=\"All tags\"\n          keywords={[`blog`, `gatsby`, `javascript`, `react`]}\n        />\n        {this.getTagsHTML(dealWithTags(tags))}\n      </Layout>\n    )\n  }\n}\n\n\nexport default TagsPage\n\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n        author\n      }\n    }\n    allMarkdownRemark {\n      edges {\n        node {\n          frontmatter {\n            tags\n            draft\n          }\n        }\n      }\n    }\n    allNavigationJson {\n      edges {\n        node {\n          name\n          link\n        }\n      }\n    }\n  }\n`\n/**\n将graphql查询的结果进行处理\n原数据结果：\n[\n  {\n    \"node\": {\n      \"frontmatter\": {\n        \"tags\": [\"aaa\", \"bbb\"]\n      }\n    }\n  }\n]\n处理为：\n[\n  {\n    \"tagValue\": \"aaa\",\n    \"tagLink\": \"aaa\",\n    \"tagCount\": 1\n  },\n  {\n    \"tagValue\": \"bbb\",\n    \"tagLink\": \"bbb\",\n    \"tagCount\": 1\n  }\n]\n另外，进行一些边界处理\n*/\nfunction dealWithTags(arr) {\n  // 将多个tag先拆分出来\n  const result = [];\n  let noTagCount = 0; // 统计没有tag的个数\n  arr.forEach((item) => {\n    const { tags, draft } = item.node.frontmatter;\n    if (draft) return;  // 屏蔽草稿\n    if (tags && tags.length > 0) {\n      tags.forEach((tag) => {\n        const index = findIndex(result, (node) => (node.tagValue === tag));\n        if (index >= 0) {\n          result[index]['tagCount']++;\n        } else {\n          result.push({\n            tagValue: tag,\n            tagLink: commonUtils.getHash(tag),\n            tagCount: 1,\n          })\n        }\n      })\n    } else {\n      noTagCount++;\n    }\n  });\n  if (noTagCount > 0) {\n    result.push({\n      tagValue: '未标记',\n      tagLink: 'untag',\n      tagCount: noTagCount,\n    });\n  }\n  return result;\n}"],"names":["TagsPage","getTagsHTML","tags","tagsHTML","forEach","tag","index","push","className","key","Link","to","tagLink","tagValue","tagCount","render","this","props","data","location","site","allMarkdownRemark","allNavigationJson","pathname","siteMetadata","edges","navs","reg","RegExp","rePathname","replace","metadata","title","keywords","arr","result","noTagCount","item","node","frontmatter","draft","length","commonUtils","dealWithTags","React"],"sourceRoot":""}